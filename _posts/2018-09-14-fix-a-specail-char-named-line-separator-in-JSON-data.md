---
layout: blog
title: ä¿®å¤ä¸€ä¸ªåœ¨JSONæ•°æ®ä¸­ç‰¹æ®Šå­—ç¬¦é—®é¢˜
tags: []
categories: [js]
summary: èŽ«åå…¶å¦™çš„æŠ¥é”™

---

### èƒŒæ™¯

æœ‰ä¸€å¤©æŽ¥åˆ°ä¸€ä¸ªæŠ¥éšœï¼Œè¯´æœ‰ä¸ªç½‘é¡µæ— æ³•æˆªå›¾ã€‚ç„¶åŽæˆªå›¾æœåŠ¡çš„æŠ¥é”™æ˜¯`undefined is not a function`ã€‚

ç„¶åŽï¼Œçœ‹äº†ä¸€ä¸‹é‚£å—æŠ¥é”™çš„ä»£ç ï¼Œå‘çŽ°é‚£ä¸ªæ•°æ®æ˜¯ä»Žé¡µé¢ä¼ é€’è¿‡æ¥çš„ï¼ˆwindow.xxx={JSON}ï¼‰ã€‚

ä½†æ˜¯ï¼Œé—®é¢˜æ˜¯åŒç±»åž‹çš„å…¶ä»–é¡µé¢æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå”¯ç‹¬è¿™ä¸€ä¸ªé¡µé¢ä¼šæŠ¥é”™ã€‚

è¿˜æœ‰ä¸€ä¸ªæ›´å¥‡æ€ªçš„æ˜¯ï¼Œåœ¨Chromeæ˜¯å¯ä»¥æ­£å¸¸æ˜¾ç¤ºçš„ã€‚

ç„¶åŽï¼Œå› ä¸ºæˆªå›¾æœåŠ¡æ˜¯ç”¨photomjså®žçŽ°çš„ï¼Œè¿™ä¸ªé—®é¢˜ä¸€æ—¶è¿˜ä¸å¥½æŽ’æŸ¥ã€‚

ç›´åˆ°...

### åˆæ­¥å®šä½

åˆä¸€ä¸ªåŒå­¦ï¼Œè¯´å®ƒåšçš„é¡µé¢åœ¨æ‰‹æœºä¸Šæ— æ³•è®¿é—®ã€‚

ç„¶åŽï¼Œä¸€æŽ’æŸ¥ï¼Œå‘çŽ°å’Œä¸Šé¢ç¢°åˆ°çš„æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚èµ¶ç´§ç”¨æ‰‹æœºè®¿é—®å‘ç”Ÿä¸Šé¢é—®é¢˜çš„é“¾æŽ¥ï¼ŒçœŸçœŸæ˜¯ä¹Ÿä¸èƒ½è®¿é—®ã€‚

å†ç”¨Chromeæ‰‹æœºè°ƒè¯•ï¼Œæ‰“å¼€æŽ§åˆ¶å°ï¼Œå‘çŽ°åœ¨æŠ¥`undefined is not a function`ä¹‹å‰ï¼Œè¿˜æœ‰ä¸€ä¸ªæŠ¥é”™`invalid or unexpected token`ã€‚

åˆæ­¥æ€€ç–‘æ˜¯å‡ºçŽ°ASCIIç ä¸­å‰é¢çš„å°äºŽ32ï¼ˆç©ºæ ¼ï¼‰çš„å­—ç¬¦ã€‚

ä½†æ˜¯æ‰§è¡Œäº†`document.body.innerHTML.split('').filter(a => a.charCodeAt(0) < 32)`å‘çŽ°æ˜¯ä¸ªç©ºæ•°ç»„ã€‚

ä¹Ÿå°±æ˜¯ï¼Œä¸æ˜¯è¿™ä¸ªé—®é¢˜ã€‚

é‚£ä¼šæ˜¯ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ

### æœ€ç»ˆå®šä½

é‚£ä¹ˆå°±å¼€å§‹ç”¨æŽ’é™¤æ³•ï¼Œä¸€ç‚¹ä¸€ç‚¹çš„åˆ é™¤ä»£ç ã€‚

ç»ˆäºŽï¼Œçš‡å¤©ä¸è´Ÿè‹¦å¿ƒäººå•Šï¼Œå‘çŽ°äº†æŠ¥é”™çš„é‚£æ®µä»£ç ã€‚

ç„¶åŽï¼Œå¤åˆ¶è¿™æ®µä»£ç åˆ° Visual Code é‡Œï¼Œé€å­—é€å­—çœ‹ï¼Œç»ˆäºŽå‘çŽ°é‚£ä¸ªæ‰“ç€é—®å·çš„è±å½¢å­—ç¬¦ï¼ˆå°±æ˜¯æ— æ³•è¯†åˆ«çš„å­—ç¬¦ï¼‰ã€‚

å¤åˆ¶åˆ°æŽ§åˆ¶å°ï¼Œæ‰§è¡Œ`'â€¨'.charCodeAt(0)` çš„ç»“æžœæ˜¯ 8232ã€‚

è¿™æ˜¯ä»€ä¹ˆé¬¼ï¼ŸðŸ‘»

ç„¶åŽï¼Œç½‘ä¸Šä¸€æœç´¢ï¼Œè¿™ä¸ªæ˜¯è¡Œåˆ†å‰²ç¬¦ï¼ˆline separatorï¼‰ã€‚

### è§£å†³

ç›´æŽ¥è¿‡æ»¤è¿™ä¸ªç‰¹æ®Šçš„å­—ç¬¦ã€‚

```js
const REG_LINE_SEPARATOR = new RegExp(String.fromCharCode(8232), 'g');

html = html.replace(REG_LINE_SEPARATOR, '');
```

ä½†æ˜¯ï¼ŒçœŸçš„ä¸çŸ¥é“è¿˜ä¼šä¸ä¼šæœ‰å…¶ä»–å­—ç¬¦ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚

å¦å¤–ï¼Œå°±æ˜¯ä¾æ—§å›°æƒ‘è¿™ä¸ªå­—ç¬¦æ˜¯æ€Žä¹ˆäº§ç”Ÿçš„ï¼Œå› ä¸ºåšè¿™ä¸ªé¡µé¢çš„å®žä¹ ç”Ÿç¦»èŒäº†ã€‚


